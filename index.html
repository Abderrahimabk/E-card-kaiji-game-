<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Empereur vs Esclave - Kaiji Style</title>
<style>
    body {
        font-family: Arial, sans-serif;
        background-image: url('background.jpg'); /* Assurez-vous que ce fichier existe */
        background-size: cover;
        background-position: center;
        color: white;
        text-align: center;
        margin: 0;
        padding: 20px;
    }
    h1 {
    margin-bottom: 10px;
    font-size: 2.8em; /* Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø­Ø¬Ù… Ù‚Ù„ÙŠÙ„Ø§Ù‹ */
    /* Ø§Ù„Ø®Ø· Ø§Ù„Ø¬Ø¯ÙŠØ¯: Ù‚ÙˆÙŠ ÙˆÙƒÙ„Ø§Ø³ÙŠÙƒÙŠ */
    font-family: 'Times New Roman', Times, serif; 
    font-weight: 900; /* Ø£Ù‚ØµÙ‰ Ø¯Ø±Ø¬Ø© Ø¹Ø±ÙŠØ¶Ø© */
    text-shadow: 2px 2px 4px rgba(0,0,0,0.8), 
                 0 0 10px rgba(255, 255, 255, 0.2); /* Ø¸Ù„ Ø¯Ø§ÙƒÙ† Ù„Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø¹Ù…Ù‚ */
    color: #810c2b; /* Ù„ÙˆÙ† Ø£Ø¨ÙŠØ¶ Ø«Ù„Ø¬ÙŠ */
    }

    .board {
        display: flex;
        justify-content: space-around;
        margin-top: 20px;
    }

    .cards {
        display: flex;
        flex-wrap: nowrap;
        gap: 10px;
        justify-content: center;
        max-width: 600px;
    }

    .card {
        width: 100px;
        height: 140px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 10px;
        font-weight: bold;
        cursor: pointer;
        user-select: none;
        transition: all 0.3s;
        overflow: hidden;
        background: #222;
        border: 2px solid #444;
        box-shadow: 0 4px 8px rgba(0,0,0,0.5);
    }

    .card:hover {
        transform: scale(1.08);
        border-color: #fff;
        box-shadow: 0 6px 12px rgba(255,255,255,0.2);
    }

    .hidden {
        background: #222;
        cursor: not-allowed;
        font-size: 24px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: #888;
    }

    .card img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        border-radius: 8px;
    }

    #score {
        margin-top: 20px;
        font-size: 18px;
        background: linear-gradient(90deg, #333, #555);
        padding: 10px 20px;
        border-radius: 10px;
        display: inline-block;
    }

    #message {
        margin-top: 15px;
        font-size: 20px;
        font-weight: bold;
        min-height: 50px;
        background: rgba(255,255,255,0.1);
        padding: 15px;
        border-radius: 10px;
        margin: 15px auto;
        max-width: 600px;
    }

    #timer {
        margin-top: 10px;
        font-size: 18px;
        color: #f39c12;
        font-weight: bold;
    }

    .battle-zone {
        margin-top: 30px;
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 50px;
        height: 180px;
        background: linear-gradient(45deg, rgba(255,0,0,0.1), rgba(0,0,255,0.1));
        border-radius: 15px;
        padding: 20px;
        margin: 30px auto;
        max-width: 400px;
    }

    .battle-card {
        width: 130px;
        height: 180px;
        background: #333;
        border-radius: 10px;
        overflow: hidden;
        border: 3px solid #666;
        transition: all 0.3s;
    }

    .battle-card img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .vs-text {
        font-size: 24px;
        font-weight: bold;
        color: #f39c12;
        text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
    }
</style>
</head>
<body>
    <h1> EMPEROR vs SLAVE </h1>

    <div class="board">
        <div>
            <h2>MY CARDS </h2>
            <div id="player-cards" class="cards"></div>
        </div>

        <div>
            <h2> OPPENANT  </h2>
            <div id="computer-cards" class="cards"></div>
        </div>
    </div>

    <div id="timer">â³ Temps restant : 60s</div>
    
    <div class="battle-zone">
        <div id="player-battle" class="battle-card"></div>
        <div class="vs-text">VS</div>
        <div id="computer-battle" class="battle-card"></div>
    </div>

    <div id="score">Toi: 0 | Ordinateur: 0</div>
    <div id="message">Choisissez votre carte pour commencer la bataille!</div>

    <script>
        let playerScore = 0;
        let computerScore = 0;
        let playerCards, computerCards;
        let timerInterval, timeLeft;
        let playerIsSlave = true;
        let roundsInCurrentRole = 0;
        const totalRoundsPerRole = 3;

        function getCardImage(cardType) {
            const extensions = {
                'citizen': '.jpg',
                'slave': '.jpg',
                'emperor': '.jpg'
            };
            return cardType.toLowerCase() + extensions[cardType.toLowerCase()];
        }

        // Assurez-vous que ces fichiers audio sont accessibles ou remplacez par des URLs valides
        const winSound = new Audio("https://actions.google.com/sounds/v1/cartoon/clang_and_wobble.ogg");
        const loseSound = new Audio("https://actions.google.com/sounds/v1/cartoon/cartoon_boing.ogg");
        const drawSound = new Audio("https://actions.google.com/sounds/v1/cartoon/concussive_drum_hit.ogg");

        function initGame() {
            if (playerIsSlave) {
                document.querySelector("#player-cards").previousElementSibling.textContent = "MY CARDS "; // Cible le <h2> pour le joueur
                document.getElementById("message").textContent = "En tant qu'esclave, vous devez vaincre l'empereur !";
                playerCards = ["citizen", "citizen", "citizen", "citizen", "slave"];
                computerCards = ["citizen", "citizen", "citizen", "citizen", "emperor"];
            } else {
                document.querySelector("#player-cards").previousElementSibling.textContent = "MY CARDS "; // Cible le <h2> pour le joueur
                document.getElementById("message").textContent = "En tant qu'empereur, vous devez vaincre l'esclave !";
                playerCards = ["citizen", "citizen", "citizen", "citizen", "emperor"];
                computerCards = ["citizen", "citizen", "citizen", "citizen", "slave"];
            }
            renderCards();
            clearBattleZone();
            startTimer();
        }

        function renderCards() {
            const playerDiv = document.getElementById("player-cards");
            const compDiv = document.getElementById("computer-cards");
            playerDiv.innerHTML = "";
            compDiv.innerHTML = "";

            playerCards.forEach((c, i) => {
                const div = document.createElement("div");
                div.className = "card";
                let img = document.createElement("img");
                img.src = getCardImage(c);
                img.alt = c;
                div.appendChild(img);
                div.onclick = () => playCard(c, i);
                playerDiv.appendChild(div);
            });

            computerCards.forEach(() => {
                const div = document.createElement("div");
                div.className = "card hidden";
                
                // Ajout de l'image 'backcard.jpg' pour les cartes de l'ordinateur
                const img = document.createElement("img");
                img.src = "backcard.jpg"; // Assurez-vous que ce fichier est dans le mÃªme rÃ©pertoire
                img.alt = "Dos de carte";
                div.appendChild(img);
                // div.textContent = "?"; // Cette ligne est maintenant commentÃ©e car l'image remplace le texte
                
                compDiv.appendChild(div);
            });
        }

        function playCard(card, index) {
            stopTimer();
            playerCards.splice(index, 1);

            const compIndex = Math.floor(Math.random() * computerCards.length);
            const compCard = computerCards.splice(compIndex, 1)[0];

            showBattle(card, compCard);

            const winner = getWinner(card, compCard);

            setTimeout(() => {
                if (winner === "player") {
                    playerScore++;
                    roundsInCurrentRole++;
                    winSound.play().catch(e => console.log('Sound failed'));
                    document.getElementById("message").textContent =
                        `Tu as jouÃ© ${card.toUpperCase()}, ordinateur a jouÃ© ${compCard.toUpperCase()}. âœ… You win the round ! `;
                } else if (winner === "computer") {
                    computerScore++;
                    roundsInCurrentRole++;
                    loseSound.play().catch(e => console.log('Sound failed'));
                    document.getElementById("message").textContent =
                        `Tu as jouÃ© ${card.toUpperCase()}, ordinateur a jouÃ© ${compCard.toUpperCase()}. âŒ You lose the round !`;
                } else {
                    drawSound.play().catch(e => console.log('Sound failed'));
                    document.getElementById("message").textContent =
                        `Tu as jouÃ© ${card.toUpperCase()}, ordinateur a jouÃ© ${compCard.toUpperCase()}. â– Draw !`;
                }

                updateScore();
                
                if (roundsInCurrentRole === totalRoundsPerRole) {
                    if (!playerIsSlave) { // Si le joueur vient de finir en Empereur
                        setTimeout(() => {
                            if (playerScore > computerScore) {
                                alert("ğŸ‰ Congratulations! You won the  match !");
                            } else if (computerScore > playerScore) {
                                alert("ğŸ’€ The  computer won the match !");
                            } else {
                                alert("ğŸ‘It's a tie! There is no winner in this match .");
                            }
                            resetMatch(); // RÃ©initialise le jeu aprÃ¨s la fin de la partie complÃ¨te
                        }, 500);
                    } else { // Si le joueur vient de finir en Esclave, change de rÃ´le
                        playerIsSlave = !playerIsSlave;
                        roundsInCurrentRole = 0;
                        document.getElementById("message").textContent = `Role change! Prepare for the next round.

.`;
                        setTimeout(initGame, 3000);
                    }
                } else {
                    // Si ce n'est pas la fin des 3 rounds pour le rÃ´le actuel, continue le jeu
                    // Sauf si c'Ã©tait une Ã©galitÃ©, dans ce cas on ne relance pas initGame
                    if (winner !== "draw") {
                        setTimeout(initGame, 2000);
                    } else {
                        setTimeout(() => {
                            renderCards(); // Pour remettre les cartes en place aprÃ¨s une Ã©galitÃ©
                            startTimer();
                        }, 2000);
                    }
                }
            }, 1500);
        }

        function getWinner(player, computer) {
            if (player === computer) return "draw";
            if (player === "citizen" && computer === "slave") return "player";
            if (player === "citizen" && computer === "emperor") return "computer";
            if (player === "slave" && computer === "emperor") return "player";
            if (player === "slave" && computer === "citizen") return "computer";
            if (player === "emperor" && computer === "citizen") return "player";
            if (player === "emperor" && computer === "slave") return "computer";
            return "draw";
        }

        function updateScore() {
            document.getElementById("score").textContent =
                `Toi: ${playerScore} | Ordinateur: ${computerScore}`;
        }

        function resetMatch() {
            playerScore = 0;
            computerScore = 0;
            roundsInCurrentRole = 0;
            playerIsSlave = true; // Commence toujours en tant qu'Esclave pour une nouvelle partie
            updateScore();
            initGame();
        }

        function showBattle(player, computer) {
            const playerBattle = document.getElementById("player-battle");
            const compBattle = document.getElementById("computer-battle");
            
            const playerImg = document.createElement("img");
            playerImg.src = getCardImage(player);
            playerImg.alt = player;
            
            const compImg = document.createElement("img");
            compImg.src = getCardImage(computer);
            compImg.alt = computer;
            
            playerBattle.innerHTML = "";
            compBattle.innerHTML = "";
            playerBattle.appendChild(playerImg);
            compBattle.appendChild(compImg);
            
            playerBattle.style.transform = "scale(1.1)";
            compBattle.style.transform = "scale(1.1)";
            
            setTimeout(() => {
                playerBattle.style.transform = "scale(1)";
                compBattle.style.transform = "scale(1)";
            }, 300);
        }

        function clearBattleZone() {
            document.getElementById("player-battle").innerHTML = "";
            document.getElementById("computer-battle").innerHTML = "";
        }

        function startTimer() {
            timeLeft = 60;
            updateTimerDisplay();
            timerInterval = setInterval(() => {
                timeLeft--;
                updateTimerDisplay();
                if (timeLeft <= 0) {
                    stopTimer();
                    computerScore++;
                    
                    roundsInCurrentRole++;

                    updateScore();
                    loseSound.play().catch(e => console.log('Sound failed'));
                    document.getElementById("message").textContent = "â° Temps Ã©coulÃ©! Tu perds la manche.";
                    
                    if (roundsInCurrentRole === totalRoundsPerRole) {
                        if (!playerIsSlave) { // Si le joueur vient de finir en Empereur
                            setTimeout(() => {
                                if (playerScore > computerScore) {
                                    alert("ğŸ‰ ØªÙ‡Ø§Ù†ÙŠÙ†Ø§! Ù„Ù‚Ø¯ ÙØ²Øª ÙÙŠ Ø§Ù„Ù…Ø¨Ø§Ø±Ø§Ø© Ø¨Ø£ÙƒÙ…Ù„Ù‡Ø§!");
                                } else if (computerScore > playerScore) {
                                    alert("ğŸ’€ Ù„Ù‚Ø¯ ÙØ§Ø² Ø§Ù„ÙƒÙ…Ø¨ÙŠÙˆØªØ± ÙÙŠ Ø§Ù„Ù…Ø¨Ø§Ø±Ø§Ø©!");
                                } else {
                                    alert("ğŸ¤ ØªØ¹Ø§Ø¯Ù„! Ù„Ø§ ÙŠÙˆØ¬Ø¯ ÙØ§Ø¦Ø² ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø¨Ø§Ø±Ø§Ø©.");
                                }
                                resetMatch();
                            }, 500);
                        } else { // Si le joueur vient de finir en Esclave, change de rÃ´le
                            playerIsSlave = !playerIsSlave;
                            roundsInCurrentRole = 0;
                            document.getElementById("message").textContent = `Changement de rÃ´le ! PrÃ©parez-vous pour le prochain round.`;
                            setTimeout(initGame, 3000);
                        }
                    } else {
                        setTimeout(initGame, 2000);
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const timerColor = timeLeft <= 10 ? '#ff4444' : '#f39c12';
            document.getElementById("timer").innerHTML = 
                `<span style="color: ${timerColor}">â³ Temps restant : ${timeLeft}s</span>`;
        }

        function stopTimer() {
            clearInterval(timerInterval);
        }

        initGame();
    </script>
</body>
</html>
